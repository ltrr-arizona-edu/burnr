<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform superposed epoch analysis — sea • burnr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform superposed epoch analysis — sea"><meta property="og:description" content="Perform superposed epoch analysis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">burnr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Introduction.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Function help</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/facet_comps.html">Add composites to facet plots</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ltrr-arizona-edu/burnr" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform superposed epoch analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/ltrr-arizona-edu/burnr/blob/HEAD/R/sea.R" class="external-link"><code>R/sea.R</code></a></small>
    <div class="hidden name"><code>sea.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform superposed epoch analysis</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sea</span><span class="op">(</span><span class="va">x</span>, <span class="va">event</span>, nbefore <span class="op">=</span> <span class="fl">6</span>, nafter <span class="op">=</span> <span class="fl">4</span>, event_range <span class="op">=</span> <span class="cn">TRUE</span>, n_iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A data frame climate reconstruction or tree-ring series with row
names as years, and one numeric variable.</p></dd>
<dt>event</dt>
<dd><p>An numeric vector of event years for superposed epoch, such as
fire years, or an <code>fhx</code> object with a single series as produced by
<code><a href="composite.html">composite()</a></code>.</p></dd>
<dt>nbefore</dt>
<dd><p>The number of lag years prior to the event year.</p></dd>
<dt>nafter</dt>
<dd><p>The number of lag years following the event year.</p></dd>
<dt>event_range</dt>
<dd><p>Logical. Constrain the time series to the time period of
key events within the range of the <code>x</code> series. <code>FALSE</code> uses the entire
series, ignoring the period of key events.</p></dd>
<dt>n_iter</dt>
<dd><p>The number of iterations for bootstrap resampling.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>sea</code> object containing. This contains:</p><ul><li><p>"event_years": a numeric vector of event years.</p></li>
<li><p>"actual": a <code>data.frame</code> summary of the actual events.</p></li>
<li><p>"random": a <code>data.frame</code> summary of the bootstrapped events.</p></li>
<li><p>"departure": a <code>data.frame</code> summary of the departures of actual from
bootstrapped events.</p></li>
<li><p>"simulated": a full 2D <code>matrix</code> of the bootstrapped-values across lags.</p></li>
<li><p>"observed": a ful 2D <code>matrix</code> of "actual" events across lags.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Superposed epoch analysis (SEA) helps to evaluate fire-climate
relationships in studies of tree-ring fire history. It works by compositing
the values of an annual time series or climate reconstruction for the fire
years provided (<code>event</code>) and both positive and negative lag years.
Bootstrap resampling of the time series is performed to evaluate the
statistical significance of each year's mean value. Users interpret the
departure of the actual event year means from the simulated event year means.
Note that there is no rescaling of the climate time series <code>x</code>.</p>
<p>The significance of lag-year departures from the average climate condition
was first noted by Baisan and Swetnam (1990) and used in an organized SEA by
Swetnam (1993). Since then, the procedure has been commonly applied in fire
history studies. The FORTRAN program EVENT.exe was written by Richard Holmes
and Thomas Swetnam (Holmes and Swetnam 1994) to perform SEA for fire history
specifically. EVENT was incorporated in the FHX2 software by Henri
Grissino-Mayer. Further information about SEA can be found in the FHAES
user's manual, http://help.fhaes.org/.</p>
<p><code>sea()</code> was originally designed to replicate EVENT as closely as possible. We
have tried to stay true to their implementation of SEA, although multiple
versions of the analysis exist in the climate literature and for fire
history. The outcome of EVENT and sea should only differ slightly in the
values of the simulated events and the departures, because random draws are
used. The event year and lag significance levels should match, at least in
the general pattern.</p>
<p>Our SEA implementation borrowed from <code>dplR::sea()</code> function in how it
performs the bootstrap procedure, but differs in the kind of output provided
for the user.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Baisan and Swetnam 1990, Fire history on desert mountain range:
Rincon Mountain Wilderness, Arizona, U.S.A. Canadian Journal of Forest
Research 20:1559-1569.</p>
<p>Bunn 2008, A dendrochronology program library in R (dplR),
Dendrochronologia 26:115-124</p>
<p>Holmes and Swetnam 1994, EVENT program description</p>
<p>Swetnam 1993, Fire history and climate change in giant sequoia
groves, Science 262:885-889.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><code><a href="plot_sealags.html">plot_sealags()</a></code> plots <code>sea</code> lags and their statistical significance.</p></li>
<li><p><code><a href="print.sea.html">print.sea()</a></code> prints a pretty summary of <code>sea</code> objects.</p></li>
<li><p><code><a href="composite.html">composite()</a></code> creates fire composites, a common input to <code>sea()</code>.</p></li>
</ul></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Read in the Cook and Krusic (2004; The North American Drought Atlas)</span></span>
<span class="r-in"><span class="co"># reconstruction of Palmer Drought Severity Index (PDSI) for the Jemez</span></span>
<span class="r-in"><span class="co"># Mountains area (gridpoint 133).</span></span>
<span class="r-in"><span class="va">target_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="st">"http://iridl.ldeo.columbia.edu"</span>,</span>
<span class="r-in">  <span class="st">"/SOURCES/.LDEO/.TRL/.NADA2004"</span>,</span>
<span class="r-in">  <span class="st">"/pdsiatlashtml/pdsiwebdata/1050w_350n_133.txt"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">pdsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">target_url</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pdsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pdsi</span>, select <span class="op">=</span> <span class="st">"RECON"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Run SEA on Peggy Mesa (pgm) data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pgm</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pgm_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="composite.html">composite</a></span><span class="op">(</span><span class="va">pgm</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">pgm_sea</span> <span class="op">&lt;-</span> <span class="fu">sea</span><span class="op">(</span><span class="va">pdsi</span>, <span class="va">pgm_comp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># See basic results:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pgm_sea</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Basic plot:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pgm_sea</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven Malevich, Christopher Guiterman, Ellis Margolis.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

